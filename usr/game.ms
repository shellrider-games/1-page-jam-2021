import"listUtil";import"tc";Z={"x":0,"y":0};h=@key.pressed;G=32;W=8;H=9;C={};C.k=0;C.b=null;Q=new Sprite;Q.c=0;Q.r=0;Q.T=function();self.x=Z.x+(1+self.c)*G;self.y=Z.y+(1+self.r)*G;end function;Q.i=function();self.T;sd.sprites.push self;end function;B=new Q;B.image=img("b",".");M=new Q;M.image=img("w",".");X=new Q;X.image=img("g",".");s=function();r=list.init2d(W,H);for x in r.indexes;for y in r[x].indexes;r[x][y]=new C;end for;end for;for x in [[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[0,1],[7,1],[0,2],[7,2],[0,3],[2,3],[6,3],[7,3],[0,4],[2,4],[3,4],[6,4],[0,5],[1,5],[2,5],[6,5],[0,6],[6,6],[0,7],[1,7],[2,7],[6,7],[2,8],[3,8],[4,8],[5,8],[6,8]];r[x[0]][x[1]].k=2;end for;for x in [[4,1],[6,2],[4,3],[1,4],[5,5],[1,6],[3,2]];r[x[0]][x[1]].k=1;end for;for b in [[1,2],[3,2],[4,2],[5,2],[4,4],[4,5],[3,6]];t=new B;t.c=b[0];t.r=b[1];r[b[0]][b[1]].b=t;t.i;end for;for x in r.indexes;for y in r[x].indexes;if r[x][y].k==2 then;t=new M;t.c=x;t.r=y;t.i;else if r[x][y].k==1 then;t=new X;t.c=x;t.r=y;t.i;end if;end for;end for;return r;end function;O=function(w);for x in w.indexes;for y in w[x].indexes;if w[x][y].k==1 and w[x][y].b==null then return 0;end for;end for;return 1;end function;cls;P=0;p=new Q;p.c=2;p.r=6;w=s;p.image=img("p",".");p.m=function(A);F=p.r+A[0]-A[2];I=p.c+A[1]-A[3];if w[I][F].k>=2 then return;if w[I][F].b!=null then;E=F+A[0]-A[2];J=I+A[1]-A[3];if J<w.len and E<w[J].len and w[J][E].k<2 and w[J][E].b==null then;t=w[I][F].b;t.c=J;t.r=E;t.T;w[I][F].b=null;w[J][E].b=t;else;return;end if;end if;p.r=F;p.c=I;p.T;end function;p.i;while 1;K=[h("w"),h("d"),h("s"),h("a")];if K.sum==1 and not P then;p.m(K);P=1;end if;if K.sum==0 then P=0;if O(w) then break;end while;cls